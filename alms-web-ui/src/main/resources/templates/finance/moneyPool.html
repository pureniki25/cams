<!DOCTYPE html>
<html lang="zh-cn">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <title>Insert title here</title>
    <link rel="stylesheet" type="text/css" href="/src/css/themes/default.css" />
    <link rel="stylesheet" type="text/css" href="/plugins/iview/2.13.1/css/iview.css" />
    <title>转账流水管理</title>
</head>

<body>
    <div id="app" v-cloak>
        <card title="搜索条件">
            <i-form ref="form" :model="form" :label-width="100" inline>
                <form-item prop="acceptBank" label="转入账号">
                    <i-select v-model="form.acceptBank" style="width: 10rem" clearable>
                        <i-option v-for="item in bankList" :value="item.financeName" :key="item.financeName">{{item.financeName}}</i-option>
                    </i-select>
                </form-item>
                <form-item prop="status" label="流水状态">
                    <i-select v-model="form.status" clearable>
                        <i-option value="待领取">待领取</i-option>
                        <i-option value="已领取">已领取</i-option>
                        <i-option value="完成">完成</i-option>
                    </i-select>
                </form-item>
                <form-item prop="tradeType" label="支付类型">
                    <i-select v-model="form.tradeType" clearable>
                        <i-option value="转账">转账</i-option>
                        <i-option value="刷卡">刷卡</i-option>
                        <i-option value="现金">现金</i-option>
                    </i-select>
                </form-item>

                <form-item prop="tradeDate" label="交易日期">
                    <date-picker type="daterange" @on-change="form.tradeDateStart=$event[0];form.tradeDateEnd=$event[1];" clearable></date-picker>
                </form-item>
                <form-item prop="updateDate" label="更新日期" >
                    <date-picker type="daterange" @on-change="form.udpateDateStart=$event[0];form.udpateDateEnd=$event[1];" clearable></date-picker>
                </form-item>

                <i-button @click="search" >查询</i-button>
            </i-form>
            <!-- <ButtonGroup> -->
                <i-button @click="deleteMoneyPool">删除流水</i-button>
                <Upload 
                :action="upload.url" 
                :multiple=false 
                :with-credentials=true 
                :on-success="uploadSuccess" 
                :show-upload-list=false 
                style="float: right;" >
                    <i-button icon="ios-cloud-upload-outline" >导入流水</i-button>
                    <!-- <Button type="ghost" icon="ios-cloud-upload-outline">Upload files</Button> -->
                </Upload>
                <!-- <i-button>导入流水</i-button> -->
                <i-button @click="window.open('/finance/downloadTemplate')" style="float: right;">模板下载</i-button>
            <!-- </ButtonGroup > -->
        </card>
        <i-table :columns="table.col" :data="table.data" :loading="table.loading" @on-selection-change="selection=$event" stripe></i-table>
        <p style="text-align: center">
            <Page :total="table.total"  @on-change="page" :current="form.curPage" show-total ></Page>
        </p>

        <Modal v-model="detailShow" width="80">
            <row style="margin-bottom: 10px">
                <i-col span="2" style="text-align: right;margin-right: 10px;">
                    交易时间:
                </i-col>
                <i-col span="18" style="text-align: left;">
                    {{detail.mp.tradeDate}}
                </i-col>
            </row>
            <row style="margin-bottom: 10px">
                <i-col span="2" style="text-align: right;margin-right: 10px;">
                    记账金额:
                </i-col>
                <i-col span="18" style="text-align: left;">
                    {{numeral(detail.mp.accountMoney).format('0,0.00')}}
                </i-col>
            </row>
            <row style="margin-bottom: 10px">
                <i-col span="2" style="text-align: right;margin-right: 10px;">
                    状态:
                </i-col>
                <i-col span="18" style="text-align: left;">
                    {{detail.mp.status}}
                </i-col>
            </row>
            <row style="margin-bottom: 10px">
                <i-col span="2" style="text-align: right;margin-right: 10px;">
                    交易备注:
                </i-col>
                <i-col span="18" style="text-align: left;">
                    {{detail.mp.remark}}
                </i-col>
            </row>
            <row style="margin-bottom: 10px">
                <i-col span="2"  style="text-align: right;margin-right: 10px;">
                    业务信息:
                </i-col>
                <i-col span="18" style="text-align: left;">
                    <span v-if="detail.list.length==0">
                        无
                    </span>
                    <table v-if="detail.list.length>0">
                        <tr>
                            <td style="width:10rem" >业务编号</td>
                            <td style="width:10rem">期数</td>
                            <td style="width:10rem">转入账号</td>
                            <td style="width:10rem">客户名称</td>
                            <td style="width:10rem">领取人</td>
                            <td style="width:10rem">领取时间</td>
                            <td style="width:10rem">应还金额</td>
                            <td style="width:10rem">备注</td>
                            <td style="width:10rem">状态</td>
                        </tr>
                        <tr v-for="item in detail.list">
                            <td>{{item.businessId}}</td>
                            <td>{{item.afterId}}</td>
                            <td>{{item.acceptBank}}</td>
                            <td>{{item.customerName}}</td>
                            <td>{{item.claimUser}}</td>
                            <td>{{item.claimDate}}</td>
                            <td>{{numeral(item.planAmount).format('0,0.00')}}</td>
                            <td>{{item.remark}}</td>
                            <td>{{item.status}}</td>
                        </tr>
                    </table>
                </i-col>
            </row>
        </Modal>
    </div>
    <!-- 引入vue -->
    <script type="text/javascript" src="/plugins/vue/vue.min.js"></script>
    <!-- iview js -->
    <script type="text/javascript" src="/plugins/iview/2.13.1/js/iview.min.js"></script>
    <script type="text/javascript" src="/plugins/layui/layui.js"></script>
    <script type="text/javascript" src="/plugins/axios/axios.min.js"></script>
    <script type="text/javascript" src="/src/js/comm.js"></script>
    <script type="text/javascript" src="/properties/config.js"></script>
    <script type="text/javascript" src="/build/js/appToken.js"></script>
    <script type="text/javascript" src="/src/js/finance/moneyPool.js"></script>
</body>

</html>